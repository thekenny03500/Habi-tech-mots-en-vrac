<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Habi-tech - Mots en vrac</title>
    <link href="./style.css" rel="stylesheet" type="text/css" />
</head>

<body>
    <div class="gridApp">
        <div id="liste">
            <button id="Reset">Reset</button>
            <div id="nbMot">0/12</div>
        </div>
        <input id="entreMot" type="text" placeholder="Coucou">
        <div id="Screen" class="grid">

        </div>
    </div>

    <script>
        let listePosUsed = [];
        const listeTexte = [];
        document.getElementById('entreMot').addEventListener("keydown", (e) => {
            if (e.key === 'Enter') 
            {
                if (listePosUsed.length < 12)
                {
                    const textTaper = document.getElementById('entreMot').value.trim();
                    if (!!textTaper)
                    {
                        const divBoutonMot = document.createElement('div');
                        document.getElementById('liste').appendChild(divBoutonMot);
                        divBoutonMot.classList.add("divBouton");

                        const bouton = document.createElement('button');
                        bouton.textContent = document.getElementById('entreMot').value;
                        bouton.classList.add("boutonMot");
                        divBoutonMot.appendChild(bouton);

                        const boutonSuppr = document.createElement('button');
                        boutonSuppr.textContent = "X";
                        boutonSuppr.classList.add("boutonMotSuppr");
                        divBoutonMot.appendChild(boutonSuppr);

                        document.getElementById('entreMot').value = "";

                        let pos;
                        do
                        {
                            pos = Math.floor(Math.random() * 12);
                        } while (listePosUsed.some(m => m == pos))
                        listePosUsed.push(pos);
                        document.getElementById('nbMot').innerText = listePosUsed.length + "/12";

                        // Creation conteneur
                        const angle = Math.random() * 70 - 35;
                        const contentDiv = document.createElement('div');
                        contentDiv.classList.add('item', `pos${pos + 1}`);
                        contentDiv.style.cssText = `transform:rotate(${angle}deg);`;

                        // Creation Texte
                        const textDiv = document.createElement('div')
                        let nb = textTaper.length;
                        if (textTaper.length < 6) nb = "Min";
                        if (textTaper.length > 15) nb = "Over";
                        textDiv.classList.add('texte', `nb${nb}`);
                        contentDiv.appendChild(textDiv);
                        textDiv.innerText = textTaper;

                        let tempoConteneur = { text: divBoutonMot, content: contentDiv };
                        listeTexte.push(tempoConteneur);

                        document.getElementById("Screen").appendChild(contentDiv);

                        bouton.addEventListener('click', () => {
                            bouton.classList.add("fait");
                            textDiv.classList.add("barre");
                        });

                        boutonSuppr.addEventListener('click', () => {
                            divBoutonMot.remove();
                            contentDiv.remove();
                            listePosUsed.splice(listePosUsed.indexOf(pos), 1);
                            listeTexte.splice(listeTexte.indexOf(tempoConteneur), 1);
                            console.log(listePosUsed);
                            console.log(listeTexte);
                            document.getElementById('nbMot').innerText = listePosUsed.length + "/12";
                        });
                    }
                }
            }
        });
        document.getElementById('Reset').addEventListener('click', () => {
            listePosUsed = [];
            listeTexte.forEach((item) => {
                item.text.remove();
                item.content.remove();
                document.getElementById('nbMot').innerText = "0/12";
            });
        });

    </script>
</body>

</html>